#!/bin/bash

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è Python –Ω–∞ Debian

set -e  # –ü—Ä–µ—Ä—ã–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã..."
sudo apt update && sudo apt upgrade -y

echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤..."
sudo apt install -y python3 python3-pip python3-venv python3-dev

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è python3
if ! command -v python3 &> /dev/null; then
    echo "‚ùå –û—à–∏–±–∫–∞: Python3 –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ pip
if ! command -v pip3 &> /dev/null; then
    echo "‚ö†Ô∏è pip3 –Ω–µ –Ω–∞–π–¥–µ–Ω, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º..."
    sudo apt install -y python3-pip
fi

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
VENV_DIR="venv"
if [ -d "$VENV_DIR" ]; then
    echo "üóëÔ∏è –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ..."
    rm -rf "$VENV_DIR"
fi

echo "üîß –°–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≤ –ø–∞–ø–∫–µ '$VENV_DIR'..."
python3 -m venv "$VENV_DIR"

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
echo "‚ö° –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º pip..."
source "$VENV_DIR/bin/activate"
pip install --upgrade pip

echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ!"
echo ""
echo "üìå –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:"
echo "   source $VENV_DIR/bin/activate     # –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å"
echo "   deactivate                        # –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å"
echo ""
echo "üí° –¢–µ–∫—É—â–∏–π Python: $(which python)"
echo "üí° –¢–µ–∫—É—â–∏–π pip: $(which pip)"
echo "üí° –í–µ—Ä—Å–∏—è Python: $(python --version)"

# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—é
echo ""
echo "üöÄ –í—ã —É–∂–µ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏. –ß—Ç–æ–±—ã –≤—ã–π—Ç–∏ ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: deactivate"